

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TensorFlow graph construction &mdash; NengoDL 0.3.1.dev0 docs</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="NengoDL 0.3.1.dev0 docs" href="index.html"/>
        <link rel="up" title="Developer API" href="backend.html"/>
        <link rel="next" title="Signals" href="signals.html"/>
        <link rel="prev" title="Processes" href="processes.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> NengoDL
          

          
          </a>

          
            
            
              <div class="version">
                0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="frontend.html">User API</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Additional resources</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="backend.html">Developer API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="builder.html">Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="op_builders.html">Operator build classes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">TensorFlow graph construction</a></li>
<li class="toctree-l2"><a class="reference internal" href="signals.html">Signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="graph_optimizer.html">Operator graph optimization tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Miscellaneous utilities</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NengoDL</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="backend.html">Developer API</a> &raquo;</li>
        
      <li>TensorFlow graph construction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tensor_graph.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tensorflow-graph-construction">
<h1>TensorFlow graph construction<a class="headerlink" href="#tensorflow-graph-construction" title="Permalink to this headline">¶</a></h1>
<p>The TensorGraph class manages all the data and build processes associated with
the TensorFlow graph.  The TensorFlow graph is the symbolic description of
the computations in the network, which will be executed by the simulator.</p>
<span class="target" id="module-nengo_dl.tensor_graph"></span><dl class="class">
<dt id="nengo_dl.tensor_graph.TensorGraph">
<em class="property">class </em><code class="descclassname">nengo_dl.tensor_graph.</code><code class="descname">TensorGraph</code><span class="sig-paren">(</span><em>model</em>, <em>dt</em>, <em>step_blocks</em>, <em>unroll_simulation</em>, <em>dtype</em>, <em>minibatch_size</em>, <em>device</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nengo_dl/tensor_graph.html#TensorGraph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nengo_dl.tensor_graph.TensorGraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Manages the construction of the TensorFlow symbolic computation graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>model</strong> : <a class="reference external" href="http://pythonhosted.org/nengo/backend_api.html#nengo.builder.Model" title="(in Nengo v2.4)"><code class="xref py py-class docutils literal"><span class="pre">Model</span></code></a></p>
<blockquote>
<div><p>pre-built Nengo model describing the network to be simulated</p>
</div></blockquote>
<p><strong>dt</strong> : float</p>
<blockquote>
<div><p>length of a simulator timestep, in seconds</p>
</div></blockquote>
<p><strong>step_blocks</strong> : int</p>
<blockquote>
<div><p>controls how many simulation steps run each time the graph is
executed (affects memory usage and graph construction time)</p>
</div></blockquote>
<p><strong>unroll_simulation</strong> : bool</p>
<blockquote>
<div><p>if True, unroll simulation loop by explicitly building each iteration
(up to <code class="docutils literal"><span class="pre">step_blocks</span></code>) into the computation graph. if False, use a
symbolic loop, which is more general and produces a simpler graph, but
is likely to be slower to simulate</p>
</div></blockquote>
<p><strong>dtype</strong> : <code class="docutils literal"><span class="pre">tf.DType</span></code></p>
<blockquote>
<div><p>floating point precision to use for simulation</p>
</div></blockquote>
<p><strong>minibatch_size</strong> : int</p>
<blockquote>
<div><p>the number of simultaneous inputs that will be passed through the
network</p>
</div></blockquote>
<p><strong>device</strong> : None or <code class="docutils literal"><span class="pre">&quot;/cpu:0&quot;</span></code> or <code class="docutils literal"><span class="pre">&quot;/gpu:[0-n]&quot;</span></code></p>
<blockquote class="last">
<div><p>device on which to execute computations (if None then uses the
default device as determined by Tensorflow)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nengo_dl.tensor_graph.TensorGraph.build">
<code class="descname">build</code><span class="sig-paren">(</span><em>rng</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nengo_dl/tensor_graph.html#TensorGraph.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nengo_dl.tensor_graph.TensorGraph.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a new graph to simulate the model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rng</strong> : <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.RandomState.html#numpy.random.RandomState" title="(in NumPy v1.12)"><code class="xref py py-class docutils literal"><span class="pre">RandomState</span></code></a></p>
<blockquote class="last">
<div><p>the Simulator&#8217;s random number generator</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nengo_dl.tensor_graph.TensorGraph.build_step">
<code class="descname">build_step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nengo_dl/tensor_graph.html#TensorGraph.build_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nengo_dl.tensor_graph.TensorGraph.build_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the operators that execute a single simulation timestep
into the graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>probe_tensors</strong> : list of <code class="docutils literal"><span class="pre">tf.Tensor</span></code></p>
<blockquote>
<div><p>the Tensor objects representing the data required for each model
Probe</p>
</div></blockquote>
<p><strong>side_effects</strong> : list of <code class="docutils literal"><span class="pre">tf.Tensor</span></code></p>
<blockquote class="last">
<div><p>the output Tensors of computations that may have side-effects
(e.g., <a class="reference external" href="http://pythonhosted.org/nengo/frontend_api.html#nengo.Node" title="(in Nengo v2.4)"><code class="xref py py-class docutils literal"><span class="pre">Node</span></code></a> functions), meaning that they
must be executed each time step even if their output doesn&#8217;t appear
to be used in the simulation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nengo_dl.tensor_graph.TensorGraph.build_loop">
<code class="descname">build_loop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nengo_dl/tensor_graph.html#TensorGraph.build_loop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nengo_dl.tensor_graph.TensorGraph.build_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Build simulation loop.</p>
<p>Loop can be constructed using the <code class="docutils literal"><span class="pre">tf.while_loop</span></code> architecture, or
explicitly unrolled.  Unrolling increases graph construction time
and memory usage, but increases simulation speed.</p>
</dd></dl>

<dl class="method">
<dt id="nengo_dl.tensor_graph.TensorGraph.build_inputs">
<code class="descname">build_inputs</code><span class="sig-paren">(</span><em>rng</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nengo_dl/tensor_graph.html#TensorGraph.build_inputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nengo_dl.tensor_graph.TensorGraph.build_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets up the inputs in the model (which will be computed outside of
Tensorflow and fed in each simulation block).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rng</strong> : <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.RandomState.html#numpy.random.RandomState" title="(in NumPy v1.12)"><code class="xref py py-class docutils literal"><span class="pre">RandomState</span></code></a></p>
<blockquote class="last">
<div><p>the Simulator&#8217;s random number generator</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nengo_dl.tensor_graph.TensorGraph.build_optimizer">
<code class="descname">build_optimizer</code><span class="sig-paren">(</span><em>optimizer</em>, <em>targets</em>, <em>objective</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nengo_dl/tensor_graph.html#TensorGraph.build_optimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nengo_dl.tensor_graph.TensorGraph.build_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds elements into the graph to execute the given optimizer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>optimizer</strong> : <code class="docutils literal"><span class="pre">tf.train.Optimizer</span></code></p>
<blockquote>
<div><p>instance of a Tensorflow optimizer class</p>
</div></blockquote>
<p><strong>targets</strong> : tuple of <a class="reference external" href="http://pythonhosted.org/nengo/frontend_api.html#nengo.Probe" title="(in Nengo v2.4)"><code class="xref py py-class docutils literal"><span class="pre">Probe</span></code></a></p>
<blockquote>
<div><p>the Probes corresponding to the output signals being optimized</p>
</div></blockquote>
<p><strong>objective</strong> : <code class="docutils literal"><span class="pre">&quot;mse&quot;</span></code> or callable</p>
<blockquote class="last">
<div><p>the objective to be minimized. passing <code class="docutils literal"><span class="pre">&quot;mse&quot;</span></code> will train with
mean squared error. a custom function
<code class="docutils literal"><span class="pre">f(output,</span> <span class="pre">target)</span> <span class="pre">-&gt;</span> <span class="pre">loss</span></code> can be passed that consumes the
actual output and target output for a probe in <code class="docutils literal"><span class="pre">targets</span></code>
and returns a <code class="docutils literal"><span class="pre">tf.Tensor</span></code> representing the scalar loss value for
that Probe (loss will be averaged across Probes).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nengo_dl.tensor_graph.TensorGraph.build_loss">
<code class="descname">build_loss</code><span class="sig-paren">(</span><em>objective</em>, <em>targets</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nengo_dl/tensor_graph.html#TensorGraph.build_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nengo_dl.tensor_graph.TensorGraph.build_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds elements into the graph to compute the given objective.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>objective</strong> : <code class="docutils literal"><span class="pre">&quot;mse&quot;</span></code> or callable</p>
<blockquote>
<div><p>the objective used to compute loss. passing <code class="docutils literal"><span class="pre">&quot;mse&quot;</span></code> will use
mean squared error. a custom function
<code class="docutils literal"><span class="pre">f(output,</span> <span class="pre">target)</span> <span class="pre">-&gt;</span> <span class="pre">loss</span></code> can be passed that consumes the
actual output and target output for a probe in <code class="docutils literal"><span class="pre">targets</span></code>
and returns a <code class="docutils literal"><span class="pre">tf.Tensor</span></code> representing the scalar loss value for
that Probe (loss will be averaged across Probes).</p>
</div></blockquote>
<p><strong>targets</strong> : tuple of <a class="reference external" href="http://pythonhosted.org/nengo/frontend_api.html#nengo.Probe" title="(in Nengo v2.4)"><code class="xref py py-class docutils literal"><span class="pre">Probe</span></code></a></p>
<blockquote class="last">
<div><p>the Probes corresponding to target values in objective</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="nengo_dl.tensor_graph.mark_signals">
<code class="descclassname">nengo_dl.tensor_graph.</code><code class="descname">mark_signals</code><span class="sig-paren">(</span><em>model</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nengo_dl/tensor_graph.html#mark_signals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nengo_dl.tensor_graph.mark_signals" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark all the signals in <code class="docutils literal"><span class="pre">model</span></code> according to whether they represent
trainable parameters of the model (parameters that can be optimized by
deep learning methods).</p>
<p>Trainable parameters include connection weights, ensemble encoders, and
neuron biases.  Unless one of those signals is targeted by a Nengo learning
rule (otherwise the learning rule update conflicts with the deep learning
optimization).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>model</strong> : class:<cite>~nengo:nengo.builder.Model</cite></p>
<blockquote class="last">
<div><p>built Nengo model</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="signals.html" class="btn btn-neutral float-right" title="Signals" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="processes.html" class="btn btn-neutral" title="Processes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Applied Brain Research.
      Last updated on May 04, 2017.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.3.1.dev0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>